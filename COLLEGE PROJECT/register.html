<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="sty.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

</head>
<body>
   <header class="header">
    <a href="#" class="logo">Mybook.com</a>
   
    <nav class="navbar">
      
        <a href="#" class="active">Home</a>
        <a href="#">About Us</a>
        <a href="#">contact</a>
     
    </nav>
   </header>
   <section class="home">
    
        <div class="home-content">
           
            <div class="social-media">
                <a href="#">
                    <i class='bx bxl-linkedin-square' ></i>
                </a>
                <a href="#">
                   
                    <i class='bx bxl-instagram-alt' ></i>
                </a>
                <a href="#">
                    <i class='bx bxl-github' ></i>
                </a>
                <a href="#">
                    <i class='bx bxl-gmail' ></i>
                </a>
            </div>

            <div class="we">
                <div class="reg">
                                             <form id="form">
                     
                         <h1>Register</h1>
                         <label for="name">Enter Name:</label>
                         <input type="text" placeholder="Your Name" id="name">
                        
                         <label for="name">Enter Email:</label>
                         <input type="email" placeholder="abc@gmail.com" id="email">
                         <label for="name">phone Number:</label>
                         <input type="number" placeholder="90XXXXXXX00" id="mobile">
                         <label for="name">You Are:</label>
                         <select id="role">
                                    <option value="teacher">Teacher</option>
                                    <option value="student">Student</option>
                                    <option value="other">Others</option>
                                   </select>
                  
                              </div>       
                              <div class = "reg teacher" >
                                <br>
                                  <label for="password">Enter password</label>
                                
                                  <input type="password" placeholder="password" id="password">
                                  <br>
                                  <input type="password" placeholder="confirm password" id="confirmps">
                                
                                <br>
                               
                                 
                         <label for="name">upload profile image:</label>



                         <input type="file" id="file">
                         <br>
                         <button class="btn" type="submit">sumbit</button>
                                </form>                             
                              </div>  
              </div>
             
           </div>     
         
     </section>         
                </div>


                <script>

document.getElementById("form").addEventListener('submit', function (e) { 
            e.preventDefault();
            

           const userFile = document.getElementById("file").files[0];
           
           const formData = new FormData();

           formData.append('user_file', userFile, `${document.getElementById("name").value}.jpg`);

           fetch('http://localhost:4000/upload',{
            method:"POST",
            body:formData
           })
           .then(res=>res.json())
           .then(data=>console.log(data))
           .catch(err=>console.log(err))

           getValue();
         })
          const getValue = ()=>{

            var o = {
                name:document.getElementById("name").value,
                mobile:document.getElementById("mobile").value,
                email:document.getElementById("email").value,
                password:document.getElementById("password").value,
                role:document.getElementById("role").value
            }


            var myHeaders = new Headers();
myHeaders.append("Content-Type", "application/json");

var raw = JSON.stringify(o);

var requestOptions = {
  method: 'POST',
  headers: myHeaders,
  body: raw,
  redirect: 'follow'
};

fetch("http://localhost:4000/register", requestOptions)
  .then(response => response.json())
  .then(result =>
   {
        if(result.acknowledged){
            alert("done");
            window.location.href = "index.html";
        }
   }
   )
  .catch(error => console.log('error', error));
            //console.log(o);
        }


                </script>
               
</body>
</html>